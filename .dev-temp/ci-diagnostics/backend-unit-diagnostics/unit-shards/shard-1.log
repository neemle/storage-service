
running 161 tests
test api::admin::tests::admin_create_user_rejects_hash_failure ... ok
test api::admin::tests::audit_and_join_token_errors ... ok
test api::admin::tests::list_audit_accepts_filters ... ok
test api::admin::tests::login_logout_and_me_flow ... ok
test api::admin::tests::non_admin_tokens_block_sensitive_endpoints ... ok
test api::admin::tests::register_login_failure_returns_unauthorized ... ok
test api::admin_storage::tests::backup_and_replica_handlers_require_auth ... ok
test api::admin_storage::tests::bucket_volume_handlers_require_admin ... ok
test api::admin_storage::tests::create_backup_policy_maps_insert_error ... ok
test api::admin_storage::tests::ensure_scope_node_exists_requires_node_id_for_replica_scope ... ok
test api::admin_storage::tests::internal_error_maps_sqlx_errors ... ok
test api::admin_storage::tests::policy_validation_target_test_and_replica_mode_flow ... ok
test api::admin_storage::tests::restore_snapshot_reports_missing_source_bucket ... ok
test api::admin_storage::tests::test_backup_target_maps_parse_and_connectivity_errors ... ok
test api::admin_storage::tests::update_replica_mode_validates_target_node ... ok
test api::auth::tests::extract_token_falls_back_when_header_not_bearer ... ok
test api::console::tests::access_key_and_presign_error_paths ... ok
test api::console::tests::auth_config_reports_oidc_mode ... ok
test api::console::tests::change_password_maps_user_lookup_and_hash_errors ... ok
test api::console::tests::download_url_reports_missing_bucket ... ok
test api::console::tests::get_object_detail_forbidden_for_other_user ... ok
test api::console::tests::helpers_cover_host_without_port_and_empty_key ... ok
test api::console::tests::load_active_claim_user_rejects_disabled_user ... ok
test api::console::tests::login_marks_admin_user ... ok
test api::console::tests::me_rejects_missing_user ... ok
test api::console::tests::oidc_callback_validates_query_and_cookie_state ... ok
test api::console::tests::presign_and_signing_key_resolution ... ok
test api::console::tests::resolve_signing_key_auto_creates_when_missing ... ok
test api::console::tests::restore_env_sets_existing_value ... ok
test api::console::tests::update_bucket_validates_name_and_conflict ... ok
test api::console::tests::update_object_reports_repo_errors ... ok
test api::internal::tests::cluster_config_requires_auth ... ok
test api::internal::tests::join_cluster_persists_requested_replica_sub_mode ... ok
test api::internal::tests::normalize_join_sub_mode_handles_invalid_values ... ok
test api::internal::tests::replica_runtime_requires_auth_and_returns_values ... ok
test api::master::tests::metrics_handler_returns_payload ... ok
test api::master::tests::spawn_server_handles_bind_failure ... ok
test api::portal::tests::client_accepts_gzip_when_header_allows_it ... ok
test api::portal::tests::embedded_ui_handler_uses_embedded_dir ... ok
test api::portal::tests::embedded_ui_serves_index_for_root_and_routes ... ok
test api::portal::tests::get_embedded_asset_returns_none_when_missing ... ok
test api::portal::tests::router_embedded_fallback_serves_ui_route ... ok
test api::replica::tests::build_servers_requires_master_url ... ok
test api::replica::tests::join_cluster_requires_master_and_token ... ok
test api::replica::tests::ready_handler_accepts_reachable_master ... ok
test api::replica::tests::spawn_heartbeat_exits_without_master ... ok
test api::replica::tests::sync_replica_mode_updates_state_on_success ... ok
test api::tests::bootstrap_force_password_enabled_parses_truthy_values ... ok
test api::tests::ensure_local_node_reuses_existing ... ok
test api::tests::refresh_node_heartbeat_metrics_sets_value_for_recent_nodes ... ok
test api::volume_capacity::tests::bindings_map_groups_and_deduplicates ... ok
test api::volume_capacity::tests::writable_volume_requires_online_status ... ok
test auth::oidc::tests::authorization_url_reports_discovery_status_and_payload_errors ... ok
test auth::oidc::tests::ensure_nonce_reports_missing_claim_directly ... ok
test auth::oidc::tests::exchange_code_reports_jwks_request_and_payload_errors ... ok
test auth::oidc::tests::exchange_code_uses_test_identity_override ... ok
test auth::oidc::tests::extract_identity_requires_nonce_claim ... ok
test auth::oidc::tests::state_and_nonce_are_distinct ... ok
test auth::password::tests::verify_rejects_invalid_hash ... ok
test backup::tests::apply_backup_retention_handles_run_without_archive_key ... ok
test backup::tests::backup_policy_runner_matching_works ... ok
test backup::tests::build_snapshot_archive_maps_entry_and_render_errors ... ok
test backup::tests::error_mapping_helpers_return_expected_messages ... ok
test backup::tests::glacier_validation_rejects_missing_region ... ok
test backup::tests::memory_writer_mode3_fails_after_first_flush ... ok
test backup::tests::parse_external_targets_rejects_invalid_method_and_timeout ... ok
test backup::tests::parse_s3_url_rejects_url_without_host ... ok
test backup::tests::reject_direct_scheme_allows_http_and_rejects_direct ... ok
test backup::tests::retention_prunes_old_runs_and_helpers_cover_paths ... ok
test backup::tests::s3_bucket_name_returns_bucket_or_vault ... ok
test backup::tests::sigv4_signing_produces_expected_authorization_header ... ok
test backup::tests::test_http_target_reports_connectivity_error ... ok
test backup::tests::upload_external_target_sftp_ssh_gateway_and_other_paths ... ok
test backup::tests::upload_s3_target_parse_url_error ... ok
test backup::tests::validate_kind_specific_fields_enforces_s3_credentials ... ok
test cache::tests::cache_store_redis_uses_env_override ... ok
test cache::tests::rate_limiter_reports_cache_errors ... ok
test events::tests::env_guard_removes_missing_var_on_drop ... ok
test events::tests::publisher_sends_message_when_enabled ... ok
test jobs::tests::execute_snapshot_policy_handles_error_and_clear_paths ... ok
test jobs::tests::multipart_cleanup_returns_on_repo_error ... ok
test jobs::tests::repair_chunk_missing_returns_error ... ok
test jobs::tests::repair_chunk_skips_failed_store_without_breaking ... ok
test jobs::tests::repair_worker_step_records_error_label ... ok
test jobs::tests::running_chunk_server_shutdown_sends_signal ... ok
test jobs::tests::scrub_once_returns_on_repo_error ... ok
test jobs::tests::start_background_jobs_spawns_tasks ... ok
test meta::backup_repos::tests::create_bucket_from_snapshot_maps_bucket_insert_error ... ok
test meta::backup_repos::tests::create_bucket_snapshot_maps_object_insert_error ... ok
test meta::backup_repos::tests::replace_bucket_volume_bindings_reports_delete_error ... ok
test meta::db::tests::connect_succeeds_and_retries_on_failures ... ok
test meta::db::tests::resolve_dsn_host_with_lookup_returns_original_on_ip_host ... ok
test meta::integration::tests::provision_user_and_bucket_reports_bucket_error ... ok
test meta::migrate::tests::repair_and_retry_rejects_non_v4_versions ... ok
test meta::migrate::tests::run_migrations_repairs_version_mismatch_for_v4 ... ok
test meta::repos::tests::chunk_and_node_paths ... ok
test meta::repos::tests::consume_join_token_reports_commit_error_for_missing ... ok
test meta::repos::tests::delete_manifest_error_paths ... ok
test meta::repos::tests::delete_object_version_reports_manifest_chunks_delete_error ... ok
test meta::repos::tests::delete_object_version_updates_latest_current ... ok
test meta::repos::tests::get_chunk_checksum_reports_value_error ... ok
test meta::repos::tests::object_metadata_and_version_paths ... ok
test obs::tests::metrics_layer_poll_ready_delegates ... ok
test obs::tests::metrics_registry_handles_duplicate_registration ... ok
test s3::errors::tests::s3_error_builds_xml_response ... ok
test s3::sigv4::tests::authenticate_request_rejects_bad_secret_and_signature ... ok
test s3::sigv4::tests::authenticate_request_rejects_missing_signed_header ... ok
test s3::sigv4::tests::authenticate_request_success_with_header ... ok
test s3::sigv4_core::tests::calculate_signature_matches_known_vector ... ok
test s3::sigv4_core::tests::canonical_request_for_unsigned_get_matches_expected ... ok
test s3::sigv4_core::tests::parse_auth_params_skips_empty_key_or_value ... ok
test s3::sigv4_core::tests::parse_authorization_rejects_missing_headers ... ok
test s3::sigv4_core::tests::parse_presigned_rejects_empty_access_key ... ok
test s3::sigv4_core::tests::parse_presigned_rejects_missing_signed_headers ... ok
test s3::sigv4_core::tests::presign_url_rejects_invalid_endpoint ... ok
test s3::tests::build_head_response_omits_etag_when_missing ... ok
test s3::tests::build_object_response_streams_body_bytes ... ok
test s3::tests::delete_object_covers_versioning_and_events ... ok
test s3::tests::delete_object_version_missing_returns_error ... ok
test s3::tests::dispatch_handles_missing_bucket_and_invalid_request ... ok
test s3::tests::fetch_checksum_and_build_object_response_errors ... ok
test s3::tests::group_objects_by_delimiter_splits_prefixes ... ok
test s3::tests::handle_get_bucket_list_v2_reports_repo_error ... ok
test s3::tests::handle_object_methods_cover_head_delete_and_multi_delete ... ok
test s3::tests::handle_object_version_and_multipart_branches ... ok
test s3::tests::load_manifest_chunks_reports_repo_error ... ok
test s3::tests::object_version_requests_reject_delete_marker ... ok
test s3::tests::path_handler_public_dispatch_error_for_missing_version ... ok
test s3::tests::put_object_honors_content_type ... ok
test s3::tests::replica_dispatch_blocks_writes_and_serves_reads ... ok
test s3::tests::router_adds_cors_layer_when_configured ... ok
test s3::tests::stream_body_to_chunks_reports_tail_write_error ... ok
test s3::tests::worm_bucket_rejects_invalid_post_object_method ... ok
test s3::xml::tests::list_object_versions_includes_delete_marker_and_version ... ok
test s3::xml::tests::parse_versioning_status_variants ... ok
test storage::checksum::tests::parse_checksum_roundtrip ... ok
test storage::chunk_encryption::tests::encode_envelope_rejects_empty_and_long_key_ids ... ok
test storage::chunk_encryption::tests::load_chunk_encryption_rejects_missing_active_key_in_keyring ... ok
test storage::chunk_encryption::tests::parse_keyring_entries_accepts_multiple_keys ... ok
test storage::chunkstore::tests::chunkstore_rejects_empty_dirs ... ok
test storage::chunkstore::tests::encrypted_store_rejects_plaintext_when_disabled ... ok
test storage::chunkstore::tests::read_missing_chunk_returns_error ... ok
test storage::replication::tests::cluster_config_matches_manager ... ok
test storage::replication::tests::get_remote_chunk_reports_body_error ... ok
test storage::replication::tests::remote_errors_are_reported ... ok
test storage::replication::tests::write_and_read_chunk_local ... ok
test storage::replication::tests::write_chunk_reports_repo_error ... ok
test test_support::guard_tests::fail_trigger_guard_create_deferred_reports_error_on_trigger ... ok
test test_support::guard_tests::table_rename_guard_reports_error_on_rename ... ok
test test_support::tests::fail_trigger_guard_create_removes_trigger ... ok
test util::config::tests::computed_chunk_size_caps_at_max ... ok
test util::config::tests::load_config_accepts_secure_master_when_values_are_safe ... ok
test util::config::tests::load_config_keeps_unknown_mode_and_normalizes_replica_sub_mode ... ok
test util::config::tests::load_config_rejects_default_admin_password_in_non_dev_master ... ok
test util::config::tests::load_config_rejects_invalid_oidc_url_and_audience_values ... ok
test util::config::tests::load_config_requires_mode ... ok
test util::config::tests::load_config_trims_empty_optional_oidc_client_secret ... ok
test util::config::tests::validate_security_master_branch_executes_with_safe_values ... ok
test util::http::tests::header_value_formats_bearer ... ok
test util::runtime::tests::state_reads_and_writes_modes ... ok
test util::storage_volume::tests::to_i64_saturated_clamps_large_numbers ... ok

test result: ok. 161 passed; 0 failed; 0 ignored; 0 measured; 805 filtered out; finished in 74.07s

